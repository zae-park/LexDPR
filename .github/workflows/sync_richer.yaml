name: ğŸ”„ Auto Mirror to Organization Repo
# RICHER ì¡°ì§ì— mirror

on:
  push:
    branches:
      - '**'
    tags:
      - '**'

jobs:
  mirror_repo:
    runs-on: ubuntu-latest
    
    env:
      ORG_TOKEN: ${{ secrets.ORG_REPO_TOKEN }}
      ORG_REPO_URL: "https://github.com/richer4p/LexDPR.git"
    
    steps:
      - name: ğŸ“¥ Checkout Source Repository (Full History)
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: ğŸ”— Add Target Remote and Push All Refs (Mirror)
        env:
          ORG_TOKEN: ${{ secrets.ORG_REPO_TOKEN }}
          ORG_REPO_URL: "https://github.com/richer4p/LexDPR.git"
        if: success() && env.ORG_TOKEN != ''
        run: |
          REPO_PATH=$(echo $ORG_REPO_URL | sed -e 's|https://||')
          NEW_REMOTE="https://zae-park:${ORG_TOKEN}@${REPO_PATH}"
          
          echo "Target repository: $ORG_REPO_URL"
          
          # ì›ê²© ì €ì¥ì†Œ ì¶”ê°€
          git remote add org-mirror "$NEW_REMOTE"
          
          # ë¯¸ëŸ¬ë§ í‘¸ì‹œ
          echo "Mirroring all branches and tags..."
          git push org-mirror --mirror
          echo "âœ… Mirroring complete."