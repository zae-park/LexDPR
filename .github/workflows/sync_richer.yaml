name: ğŸ”„ Auto Mirror to Organization Repo

on:
  push:
    branches:
      - '**'
    tags:
      - '**'

jobs:
  mirror_repo:
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ Checkout Source Repository (Full History)
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: ğŸ”— Mirror to Organization Repo
        env:
          ORG_TOKEN: ${{ secrets.ORG_REPO_TOKEN }}
        run: |
          # í† í° í™•ì¸
          if [ -z "$ORG_TOKEN" ]; then
            echo "âŒ ORG_REPO_TOKEN is not set"
            exit 1
          fi
          
          # íƒ€ê²Ÿ ì €ì¥ì†Œ ì„¤ì •
          TARGET_REPO="github.com/richer4p/LexDPR.git"
          NEW_REMOTE="https://zae-park:${ORG_TOKEN}@${TARGET_REPO}"
          
          echo "ğŸ¯ Target repository: https://${TARGET_REPO}"
          
          # ì›ê²© ì €ì¥ì†Œ ì¶”ê°€
          git remote add org-mirror "$NEW_REMOTE"
          
          # ë¯¸ëŸ¬ë§ í‘¸ì‹œ (ëª¨ë“  ë¸Œëœì¹˜ì™€ íƒœê·¸, ì»¤ë°‹ ì‘ì„±ì ì •ë³´ ìœ ì§€)
          echo "ğŸ”„ Mirroring all branches and tags..."
          git push org-mirror --mirror
          
          echo "âœ… Mirroring complete!"